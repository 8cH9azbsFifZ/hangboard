<!DOCTYPE html>
<html>
<head>
	<title>Hangboard</title>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

	<script id=myScript>
		function toggleDisplay(me)
		{
			if(me.getAttribute("display")=="inline")
				me.setAttribute("display","none")
			else
				me.setAttribute("display","inline")
		}
	</script>

	<script>
		function DisplayHolds(hold)
		{
			hold.setAttribute("display","inline");
		}
		function HideHolds(hold)
		{
			hold.setAttribute("display","none");
		}
	</script>

	<!--- Progress Bar -->
	<script>
		var source = new EventSource("/progress");
		source.onmessage = function(event) {
			var parsed = JSON.parse(event.data);
			var completed = parsed.Completed;

			$('.progress-bar').css('width', completed+'%').attr('aria-valuenow', completed);
			$('.progress-bar-label').text(completed+'% of ' + parsed.Duration + "(s)");
			var togo = parsed.Duration-parsed.Counter;
			$('.exercise-label').text("Exercise: " + parsed.Type + " for " + parsed.Duration + "(s) and still " + togo + "(s) remaining.");

			if (parsed.Counter < 3)
			{
				if (parsed.Left != "") { DisplayHolds(parsed.Left); } else { A1.setAttribute("display","none") }
				if (parsed.Right != "") { DisplayHolds(parsed.Right); } else { A7.setAttribute("display","none") }
			} 

		}
	</script>

	<script>
		document.addEventListener("onload",inlineSVG(),false)
		function inlineSVG()
		{
			var SVGFile="{{url_for('static', filename='zlagboard.svg')}}"
			var loadXML = new XMLHttpRequest;
			function handler(){
			if(loadXML.readyState == 4 && loadXML.status == 200)
				svgInlineDiv.innerHTML=loadXML.responseText
			}
			if (loadXML != null){
				loadXML.open("GET", SVGFile, true);
				loadXML.onreadystatechange = handler;
				loadXML.send();
			}
		}
	</script>



</head>
<body>

	<div>
		<span class="exercise-label">Exercise: </span>
	</div>
	<!--- Progress Bar -->
	<div style="margin: 50px;">
		<div class="progress" style="width: 50%;">
			<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
				<span class="progress-bar-label">0%</span>
			</div>
		</div>

		<div style="width: 30%">
			<div id="svgInlineDiv" style="width: 30%"></div>
		</div>
	</div>

	<div>
        <form method="post" action="/">
                <input type="submit" value="Start" name="Start"/>
                <input type="submit" value="Stop" name="Stop" />
        </form>
	</div>





</body>
</html>
