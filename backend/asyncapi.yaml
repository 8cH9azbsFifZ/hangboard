asyncapi: 2.0.0
info:
  title: Hangboard application
  version: '0.0.1'
  description: |
    Force sensing hangboard application.
    Backend communication protocol.
  license:
    name: Apache 2.0
    url: 'https://www.apache.org/licenses/LICENSE-2.0'
servers:
  mosquitto:
    url: mqtt://t20
    protocol: mqtt
channels:
  hangboard/workout/control:
    publish:
      summary: Control the hangboard timer.
      operationId: onControlTimer
      message:
        name: ControlTimer
        payload:
          type: object
          properties:
            command:
              type: string
              description: Command.      
              pattern: '^Start .+$'     
  hangboard/workout/holds:
    subscribe:
      summary: Information on the currently used holds.
      operationId: GetConfiguredHolds
      message:
        name: Holds Used
        payload:
          type: object
          properties:
            left:
              type: string
              description: Left hold.
              examples: ["A1","A2"]
            right:
              type: string
              description: Right hold.
              examples: ["A7","A6"]
  hangboard/workout/setinfo:
    subscribe:
      summary: Get information on the current set.
      operationId: GetSetInfo
      message:
        name: Current Set
        payload:
          type: object
          properties:
            resttostart:
              type: integer
              minimum: 0 
              description: Rest to start time in seconds.
              example: 5
            exercise:
              type: string
              description: Exercise short description.
              examples: ["Hang","Pull Up"]
            counter:
              type: integer
              minimum: 0
              description: How long to run in seconds or how much repetitions (for pull ups).
              example: 10
            pause:
              type: integer
              minimum: 0 
              description: Pause between the exercises in seconds.
              example: 5
            reps:
              type: integer
              minimum: 0
              description: Number of exercise repetitions in this set.
              example: 3
            left:
              type: string
              description: Left hold to use.
              examples: ["A1","JUG"]
            right:
              type: string
              description: Right hold to use.
              examples: ["A7","EDGE"]
            type: 
              type: string
              description: Type of exercise.
              examples: ["Hang", "Maximum Hang", "Pull Up"]
  hangboard/sensor/load/loadstatus:
    subscribe:
      summary: Information on the current load status including the calculated values.
      operationId: GetCurrentLoadStatus
      message:
        name: Load Status
        payload:
          type: object
          properties:
            time:
              type: integer
              description: Timestamp in seconds.
              example: 123412341234
            loadcurrent:
              type: number
              description: Current load in kg.
              example: 23.2